<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="{{packageInfo.description}}">
	<link rel="apple-touch-icon" href="apple-touch-icon.png">
	<title>Estimation Poker</title>
	<link rel="stylesheet" href="css/lib/bootstrap.min.css?{{packageInfo.version}}">
	<link rel="stylesheet" href="css/style.css?{{packageInfo.version}}">
	{{#piwik}}
	<script>
		// Set up client error tracking
		var _paq = _paq || [];
		window.onerror = function(message, file, line) {
			var sFormattedMessage = '[' + file + ' (' + line + ')] ' + message;
			_paq.push(['trackEvent', 'Errors', 'Browser', sFormattedMessage, null, true]);
		}
	</script>
	{{/piwik}}
</head>
<body data-bind="pageTitle: statusTitle">
	<div class="container">

		<div class="alerts  col-lg-12">
			<div class="alerts__connection  alert  alert-info" role="alert" data-bind="visible: !localUser().isConnected()">
				<span class="glyphicon glyphicon-flash"></span>
				Connecting...
			</div>
		</div>

		<div class="title col-lg-12">
			<h1>
				<svg
					class="logo"
					xmlns="http://www.w3.org/2000/svg"
					version="1.1"
					viewBox="0 0 207.51738 215.32033"
					preserveAspectRatio="xMinYMin meet"
				>
					<g transform="translate(-175.38412,-203.68362)">
					<rect
						class="logo__card logo__card-1"
						width="115.71429"
						height="165.71428"
						ry="23.214285"
						x="-466.39459"
						y="89.710724"
						transform="matrix(-0.91172498,-0.41080112,-0.41080112,0.91172498,0,0)"
					/>
					<rect
						class="logo__card logo__card-2"
						width="115.71429"
						height="165.71428"
						ry="23.214285"
						x="-390.5545"
						y="144.7487"
						transform="matrix(-0.97594167,-0.21803177,-0.21803177,0.97594167,0,0)"
					/>
					<rect
						class="logo__card logo__card-3"
						width="115.71429"
						height="165.71428"
						ry="23.214285"
						x="-293.86633"
						y="225.41742"
						transform="matrix(-0.99999782,-0.00208602,-0.00208602,0.99999782,0,0)"
				   />
				  </g>
				</svg>
				Estimation Poker
			</h1>
		</div>
		<div class="story col-lg-4">
			<h2>The Story</h2>
			<blockquote class="story-title">
				<p data-bind="editableText: storyTitle" data-edit-hint="<edit story title>"></p>
			</blockquote>
		</div>

		<div class="estimations col-lg-8" data-bind="css: {'estimations--incomplete': !$root.estimationsComplete()}">
			<h2>The Estimations</h2>
			<table class="table">
				<tbody class="local-user" data-bind="with: localUser">
					<tr>
						<td>
							<span class="username" data-bind="editableText: name" data-edit-hint="<your name>"></span>
							<span class="btn-group" data-bind="estimationSelect: estimation"></span>
						</td>
						<td>
							<!-- ko component: {
								name: 'card',
								params: {
									user: $data
								}
							} -->
							<!-- /ko -->
						</td>
					</tr>
				</tbody>
				<tbody class="remote-users" data-bind="foreach: users">
					<tr>
						<td class="name" data-bind="
							text: displayName,
							css: {'name--default': displayName() !== name()}
						"></td>
						<td>
							<!-- ko component: {
								name: 'card',
								params: {
									user: $data
								}
							} -->
							<!-- /ko -->
						</td>
					</tr>
				</tbody>
				<tbody class="summary">
					<tr>
						<td>Team estimation (max)</td>
						<td>
							<div class="card  summary__card" data-bind="
								attr: {'class': 'card  summary__card  card--'+$root.highestEstimation()}
							">
								<div class="card__number" data-bind="
									text: $root.highestEstimation()"
								></div>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
			<button class="new-round-btn btn btn-sm" data-bind="click: initNewRound">
				<span class="glyphicon glyphicon-repeat"></span>
				New Round
			</button>

			<div class="tutorial tutorialNote" data-bind="visible: users().length == 0">
				<h3>
				You are alone.
				</h3>
				<p>
				Share this URL with your team members:
				</p>
				<pre><a data-bind="attr: {href: window.location}, text: window.location"></a></pre>
				<a class="btn btn-default" data-bind="attr: {href: mailtoHref}">
					<span class="glyphicon glyphicon-envelope"></span>
					Share via e-mail
				</a>
			</div>
		</div>


	</div>

	<!--
	Reusable "card" component that is used for both local and remote
	users. Including a little dirty hack with the attr binding to achieve
	code-generated classes for the card values. -->
	<template id="card">

		<div class="card" data-bind="
			attr: {'class': 'card  card--'+user.estimation()},
			css: {
				'card--unplayed': user.estimation() === false,
				'card--max': user.estimation() === $root.highestEstimation(),
				'card--min': user.estimation() === $root.lowestEstimation()
			}
		">
			<div class="card__number" data-bind="text: user.estimation"></div>
		</div>
	</template>

	{{^productionMode}}
	<script src="/socket.io/socket.io.js"></script>
	<script src="js/lib/knockout-debug.js"></script>

	<script src="js/tools.js"></script>
	<script src="js/models.js"></script>
	<script src="js/bindings.js"></script>
	<script src="js/app.js"></script>
	{{/productionMode}}

	{{#productionMode}}
	<script src="js/client.prod.min.js?{{packageInfo.version}}"></script>
	{{/productionMode}}

	{{#piwik}}
	<!-- Piwik -->
	<script type="text/javascript">
	  var _paq = _paq || [];
	  _paq.push(['trackPageView']);
	  _paq.push(['enableLinkTracking']);
	  (function() {
		var u=(("https:" == document.location.protocol) ? "https" : "http") + "://{{piwik.url}}/";
		_paq.push(['setTrackerUrl', u+'piwik.php']);
		_paq.push(['setSiteId', {{piwik.siteId}}]);
		var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
		g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
	  })();
	</script>
	<noscript><p><img src="http://{{piwik.url}}/piwik.php?idsite={{piwik.siteId}}" style="border:0;" alt="" /></p></noscript>
	<!-- End Piwik Code -->
	{{/piwik}}
</body>
</html>